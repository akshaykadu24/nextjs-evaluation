import Head from 'next/head'
import Image from 'next/image'
import { Inter } from '@next/font/google'
import styles from '../styles/Home.module.css'
import axios from "axios"
import { Box, Button, Flex, Heading, SimpleGrid } from '@chakra-ui/react'
import Link from 'next/link'

const inter = Inter({ subsets: ['latin'] })

export default function Home({data}) {
  const {prof,repo} =data
  // console.log(prof,repo)
  return (
    <>
      <Head>
        <title>Github Portfolio</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <SimpleGrid columns={[1,1,2,2]} >
          
          <Box >
            <Image style={{borderRadius:"50%"}}  src={prof.avatar_url} width={150} height={150} alt={prof.name} />
            <Heading>{prof.name}</Heading>
            <Heading size="md">@{prof.login}</Heading><br/>
            <>{prof.bio}</><br/><br/>
            <Flex gap={2}>
              <Link href={""}><Button bg={"skyblue"}>Resume</Button> </Link> 
              <Link href={"https://github.com/riteshf"}><Button bg={"skyblue"}>Follow</Button></Link>
              
            </Flex>
            <Box><br/>
            <SimpleGrid columns={[3,4]} >
              {
                prof.bio.split('|').map((el)=>{
                  return(<Box key={el}> <Button size={"sm"}>{el}</Button>  </Box>)
                })
              }
            </SimpleGrid>
            </Box><br/>
            <Box>
              {
                prof.company.split(" @").map((el)=>{
                  return (<Box key={el}> Senior Software Engineer at {el} </Box>)
                })

              }
            </Box>
            
          </Box>
          <Box >
            <Heading>Projects</Heading>
            <SimpleGrid columns={4} spacing={10} >
              {
                repo.items.map((el)=>{
                  return (
                    <Link key={el.name} href={el.html_url}>
                      <Box  width={500} bg={"lightgrey"} padding={5}>
                    <Heading size="md">{el.name}</Heading>
                    <Box>
                    <Box>forks: {el.forks_count}</Box>
                    <Heading size="sm"> language: {el.language}</Heading>
                    </Box>
                      < Box>following: {el.stargazers_count}</Box>
                   
                  </Box>
                  </Link>)
                })
              }
            </SimpleGrid>
          </Box>
        </SimpleGrid>
      </main>
    </>
  )
}

export async function getServerSideProps(){
  let res = await axios.get("https://api.github.com/users/riteshf")
  let res2 = await axios.get("https://api.github.com/search/repositories?q=user:riteshf+fork:true&sort=updated&per_page=10&type=Repositories")
  let data = { prof:res.data,  repo:res2.data }
  return{
    props:{
      data:data

      }
    }
  }

